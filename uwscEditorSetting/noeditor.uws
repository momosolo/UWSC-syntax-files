///////////////////////////////////////////////////////////////////////////////
// NoEditor
// http://www.yokkasoft.net/

classList["noeditor"] = true

class noeditor
TEXTBLOCK header
[VERSION]
IniVersion=2
[SYOKI]
EXT=.uws
ShortName=UWSC
LongName=UWSC用強調ファイル
Sakiyomi=1
Case=0
[Fountain]
ENDTEXTBLOCK

TEXTBLOCK body
545046300D5453514C45466F756E7461696E0D5361766530466F756E7461696E
0354616702141346696C654578744C6973742E537472696E67730106042E7577
730008427261636B6574730E01114974656D436F6C6F722E426B436F6C6F7207
06636C4E6F6E650F4974656D436F6C6F722E436F6C6F720707636C426C61636B
0F4974656D436F6C6F722E5374796C650B066673426F6C64000B4C6566744272
61636B6574060974657874626C6F636B0C5269676874427261636B6574060C65
6E6474657874626C6F636B0001114974656D436F6C6F722E426B436F6C6F7207
06636C4E6F6E650F4974656D436F6C6F722E436F6C6F720707636C426C61636B
0F4974656D436F6C6F722E5374796C650B066673426F6C64000B4C6566744272
61636B6574060954455854424C4F434B0C5269676874427261636B6574060C45
4E4454455854424C4F434B00000F526573657276652E426B436F6C6F72070663
6C4E6F6E650D526573657276652E436F6C6F720706636C426C75650D52657365
7276652E5374796C650B066673426F6C64001752657365727665576F72644C69
73742E537472696E677301[keyword1]000C48544D4C4D656E75466C61
67081056696577466F6E742E43686172736574071053484946544A49535F4348
41525345540E56696577466F6E742E436F6C6F72070C636C57696E646F775465
78740F56696577466F6E742E48656967687402F40D56696577466F6E742E4E61
6D6512080000002DFF33FF200030FFB430B730C330AF300E56696577466F6E74
2E5374796C650B00074F7267466F6E7408094F7267456469746F720808546162
436F756E740204094261636B436F6C6F720707636C5768697465074F72675772
617008084175746F5772617002000B416E6B2E426B436F6C6F720706636C4E6F
6E6509416E6B2E436F6C6F720706636C4E6F6E6509416E6B2E5374796C650B00
0D4361736553656E736974697665080E436F626F6C4C696E65436F6C6F720708
636C53696C7665720F436F6D6D656E742E426B436F6C6F720706636C4E6F6E65
0D436F6D6D656E742E436F6C6F720707636C477265656E0D436F6D6D656E742E
5374796C650B000C444243532E426B436F6C6F720706636C4E6F6E650A444243
532E436F6C6F720707636C426C61636B0A444243532E5374796C650B000B496E
742E426B436F6C6F720706636C4E6F6E6509496E742E436F6C6F720707636C42
6C61636B09496E742E5374796C650B000C4D61696C2E426B436F6C6F72070663
6C4E6F6E650A4D61696C2E436F6C6F720706636C426C75650A4D61696C2E5374
796C650B0B6673556E6465726C696E65000A507265436F6D6D656E7409145072
6550726F6365737365722E426B436F6C6F720706636C4E6F6E65125072655072
6F6365737365722E436F6C6F720706636C4E6F6E651250726550726F63657373
65722E5374796C650B001052657365727665322E426B436F6C6F720706636C4E
6F6E650E52657365727665322E436F6C6F720708636C507572706C650E526573
65727665322E5374796C650B066673426F6C64001052657365727665332E426B
436F6C6F720706636C4E6F6E650E52657365727665332E436F6C6F720708636C
4D61726F6F6E0E52657365727665332E5374796C650B066673426F6C64001052
657365727665342E426B436F6C6F720706636C4E6F6E650E5265736572766534
2E436F6C6F720709636C467563687369610E52657365727665342E5374796C65
0B066673426F6C64001052657365727665352E426B436F6C6F720706636C4E6F
6E650E52657365727665352E436F6C6F720705636C5265640E52657365727665
352E5374796C650B066673426F6C64001852657365727665576F72644C697374
322E537472696E677301[keyword2]001852657365727665576F72644C
697374332E537472696E677301[keyword3]001852657365727665576F
72644C697374342E537472696E677301[keyword4]0018526573657276
65576F72644C697374352E537472696E677301[keyword5]001753696E
676C6551756F746174696F6E2E426B436F6C6F720706636C4E6F6E651553696E
676C6551756F746174696F6E2E436F6C6F720707636C426C61636B1553696E67
6C6551756F746174696F6E2E5374796C650B066673426F6C64000E53796D626F
6C2E426B436F6C6F720706636C4E6F6E650C53796D626F6C2E436F6C6F720706
636C426C75650C53796D626F6C2E5374796C650B000B55726C2E426B436F6C6F
720706636C4E6F6E650955726C2E436F6C6F720706636C426C75650955726C2E
5374796C650B0B6673556E6465726C696E6500084C6F6E674E616D65120B0000
0055005700530043002875375FBF8AD530A130A430EB3008426F6F6C4D61696C
0907426F6F6C55726C0909436F6D6D656E74657206022F2F0E436F6D6D656E74
6572324279746502FF0E436F6D6D656E746572334279746502FF0D436F6D6D65
6E7465724279746502FF09496E694C6F6164656409094C6F6E674E616D655712
0B00000055005700530043002875375FBF8AD530A130A430EB300951756F7461
74696F6E0601220A51756F746174696F6E32060974657874626C6F636B0A5175
6F746174696F6E33060954455854424C4F434B0D51756F746174696F6E43524C
46080E51756F746174696F6E43524C4632090E51756F746174696F6E43524C46
33090E51756F746174696F6E43524C4634080E51756F746174696F6E52696768
740601220F51756F746174696F6E526967687432060C656E6474657874626C6F
636B0F51756F746174696F6E526967687433060C454E4454455854424C4F434B
0853616B69796F6D69090953686F72744E616D650604555753430D53686F7743
6F626F6C4C696E65080D576F726B312E426B436F6C6F720706636C4E6F6E650B
576F726B312E436F6C6F720707636C426C61636B0B576F726B312E5374796C65
0B0009576F726B3143617365080D576F726B322E426B436F6C6F720706636C4E
6F6E650B576F726B322E436F6C6F720707636C426C61636B0B576F726B322E53
74796C650B0009576F726B3243617365080000
ENDTEXTBLOCK

	const directory = "noeditor"
	const fileName = "UWSC.kwd"
	const hilightPath = directory + "\" + fileName
	const openMode = F_WRITE1 or F_NOCR
	dim fid
	
	procedure openFile;  fid = fopen(hilightPath, openMode); fend
	procedure closeFile; fclose(fid); fend
	
	procedure putHeader; fput(fid, header); fend
	procedure putFooter; ; fend
	
	procedure putBody
		dim keyword[]="","","","",""
		
		for index = 0 to length(syntaxData)-1
			csvArray = split(syntaxData[index, HASH_VAL], ",", false, false)
			syntax = csvArray[0]
			category1 = csvArray[1]
			category2 = csvArray[2]
			
			select category1
				case "スクリプト関数"
					keyword[0] = keyword[0] + encodeKeyword(syntax)
				case "スクリプト構文"
					keyword[1] = keyword[1] + encodeKeyword(syntax)
				case "定数"
					keyword[2] = keyword[2] + encodeKeyword(syntax)
				case "配列変数"
					keyword[3] = keyword[3] + encodeKeyword(syntax)
				case "特殊変数"
					keyword[4] = keyword[4] + encodeKeyword(syntax)
			selend
		next
		
		replaceBody = replace(body, crlf, "")
		for i=0 to length(keyword)-1
			replaceStr = "[keyword" + (i+1) + "]"
			replaceBody = replace(replaceBody, replaceStr, keyword[i])
		next
		
		fountainLine = ceil(length(replaceBody)/64)
		outputBody = "Fountain_c=" + fountainLine + crlf
		
		for i=0 to fountainLine-1
			lineStr = copy(replaceBody, i*64 + 1, 64)
			outputBody = outputBody + "Fountain_d" + i + "=" + lineStr + crlf
		next
		
		fput(fid, outputBody)
	fend
	
	function encodeKeyword(keyword)
		//「KEY1_1」という文字列を変換するのであれば
		// 06（区切り固定？）
		// 06（文字列サイズ）
		// 4B4559315F31（文字コード）
		// 06064B4559315F31
		result = "06"
		
		keywordSize = length(keyword)
		result = result + replace(format(keywordSize, 2, -1), " ", "0")
		for i=1 to length(keyword)
			ch = copy(keyword, i, 1)
			result = result + format(asc(ch), 2, -1)
		next
	fend
endclass
